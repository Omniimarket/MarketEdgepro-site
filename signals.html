<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MarketProEdge - Daily Signals</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    .modal {
      display: none;
      position: fixed;
      z-index: 10;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.5);
    }
    .modal-content {
      background-color: #fff;
      margin: 10% auto;
      padding: 20px;
      width: 80%;
      max-width: 600px;
      border-radius: 10px;
      position: relative;
    }
    .close {
      color: #aaa;
      position: absolute;
      top: 10px;
      right: 20px;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">MarketProEdge</div>
    <nav>
      <a href="index.html">Home</a>
      <a href="#features">Features</a>
      <a href="signals.html">Signals</a>
      <a href="#pricing">Pricing</a>
      <a href="#">Login</a>
    </nav>
  </header>

  <section class="hero">
    <h1>ðŸ“Š MarketProEdge Daily Signals</h1>
    <p>Volume Profile data updated daily: POC, VAL/VAH, Gaps, and more.</p>
  </section>

  <section class="signals">
    <table>
      <thead>
        <tr>
          <th>Ticker</th>
          <th>POC</th>
          <th>POC Move</th>
          <th>VAL</th>
          <th>VAH</th>
          <th>Volume Clusters</th>
          <th>Near VAL</th>
          <th>Near VAH</th>
          <th>Chart</th>
        </tr>
      </thead>
      <tbody id="signalTable"></tbody>
    </table>
  </section>

  <div id="chartModal" class="modal">
    <div class="modal-content">
      <span class="close" id="closeModal">&times;</span>
      <canvas id="tickerChart" width="400" height="300"></canvas>
    </div>
  </div>

  <footer>
    &copy; 2025 MarketProEdge. All rights reserved.
  </footer>

  <script>
    let signals = {};

    fetch('marketproedge_signals.json')
      .then(response => response.json())
      .then(data => {
        signals = data;
        const table = document.getElementById("signalTable");

        Object.keys(data).forEach(ticker => {
          const row = document.createElement("tr");
          const d = data[ticker];
          const pocMove = d.poc_movement || "â€“";
          const pocSymbol = pocMove === "up" ? "ðŸ“ˆ" : pocMove === "down" ? "ðŸ“‰" : "âž–";

          const volumeClusters = d.volume_clusters || [];
          const clusterText = volumeClusters.length ? "ðŸ§  Hover" : "â€”";

          const nearVal = d.near_val ? "âœ…" : "";
          const nearVah = d.near_vah ? "âœ…" : "";

          row.innerHTML = `
            <td>${ticker}</td>
            <td>${d.poc ?? "â€”"}</td>
            <td title="${pocMove}">${pocSymbol}</td>
            <td>${d.val ?? "â€”"}</td>
            <td>${d.vah ?? "â€”"}</td>
            <td title="${volumeClusters.join(', ')}">${clusterText}</td>
            <td>${nearVal}</td>
            <td>${nearVah}</td>
            <td><button onclick="openChart('${ticker}')">ðŸ“ˆ Chart</button></td>
          `;
          table.appendChild(row);
        });
      });

    function openChart(ticker) {
      const d = signals[ticker];
      if (!d || !d.volume_clusters || d.volume_clusters.length === 0) return;

      const ctx = document.getElementById("tickerChart").getContext("2d");
      if (window.currentChart) window.currentChart.destroy();

      window.currentChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: d.volume_clusters.map(String),
          datasets: [{
            label: `Volume Clusters - ${ticker}`,
            data: d.volume_clusters.map(() => Math.floor(Math.random() * 100)), // Placeholder heights
            backgroundColor: "rgba(0,123,255,0.6)"
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false }
          }
        }
      });

      document.getElementById("chartModal").style.display = "block";
    }

    document.getElementById("closeModal").onclick = function () {
      document.getElementById("chartModal").style.display = "none";
    };
  </script>
</body>
</html>
